{"version":3,"file":"lockerjs.js","sources":["../src/locker.js"],"sourcesContent":["'use strict';\r\n\r\n/**\r\n * Extremely light library that makes HTML5 storage usage easier to the edge.\r\n * No dependencies, no configuration.\r\n */\r\nexport default class {\r\n\t/**\r\n\t * Creates a locker\r\n\t * @param {object} storage\r\n\t */\r\n\tconstructor(storage) {\r\n\t\tif (storage !== window.localStorage &&\r\n\t\t\tstorage !== window.sessionStorage) {\r\n\t\t\tthrow new TypeError('Invalid Storage object');\r\n\t\t} else {\r\n\t\t\tthis.storage = storage;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add a value into HTML5 window.localStorage.\r\n\t * @param {*} key\r\n\t * @param {*} value\r\n\t */\r\n\tadd(key, value) {\r\n\t\tkey = this._parseToString(key);\r\n\t\tswitch (typeof value) {\r\n\t\t\tcase 'object': {\r\n\t\t\t\tconst parsedVal = this._parseToString(value);\r\n\t\t\t\tthis.storage.setItem(key, parsedVal);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tdefault: {\r\n\t\t\t\tthis.storage.setItem(key, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add a value with a given key to the storage if a key is not already used.\r\n\t * Otherwise returns ReferenceError instead of overwriting it;\r\n\t * @param {*} key\r\n\t * @param {*} value\r\n\t */\r\n\taddSafely(key, value) {\r\n\t\tkey = this._parseToString(key);\r\n\t\tconst keyExists = this.storage.getItem(key);\r\n\t\tif (keyExists) {\r\n\t\t\tthrow new ReferenceError('Provided key is already in use');\r\n\t\t}\r\n\t\tthis.add(key, value);\r\n\t}\r\n\r\n\t/**\r\n\t * Get a value from HTML5 window.localStorage\r\n\t * @param {*} key\r\n\t * @return {*}\r\n\t */\r\n\tget(key) {\r\n\t\tkey = this._parseToString(key);\r\n\t\treturn this.storage.getItem(key);\r\n\t}\r\n\r\n\t/**\r\n\t * Saves map as-is into localstorage\r\n\t * @param {Map} map\r\n\t */\r\n\tsaveMap(map) {\r\n\t\tconst isMap = Object.prototype.toString.call(map) === '[object Map]';\r\n\t\tif (!isMap) {\r\n\t\t\tthrow new TypeError('Must be of type Map');\r\n\t\t}\r\n\t\tfor (let [key, value] of map) {\r\n\t\t\tthis.add(key, value);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Saves and returns whole storage as map\r\n\t * @return {Map} localstorageCopy\r\n\t */\r\n\tgetMap() {\r\n\t\tconst mappedStorage = new Map();\r\n\t\tfor (let i = 0; i < this.storage.length; i++) {\r\n\t\t\tlet tempKey = this._parseToString(this.storage.key(i));\r\n\t\t\tlet tempVal = this._parseToString(this.storage.getItem(tempKey));\r\n\t\t\tmappedStorage.set(tempKey, tempVal);\r\n\t\t}\r\n\t\treturn mappedStorage;\r\n\t}\r\n\r\n\t/**\r\n\t * Check whether the given key exists in the window.localStorage\r\n\t * @param {*} key\r\n\t * @return {boolean}\r\n\t */\r\n\tkeyExists(key) {\r\n\t\treturn !!this.storage.getItem(this._parseToString(key));\r\n\t}\r\n\r\n\t/**\r\n\t * Check whether the given value exists in the window.localStorage\r\n\t * @param {*} value\r\n\t * @return {boolean}\r\n\t */\r\n\tvalueExists(value) {\r\n\t\tconst parsedVal = this._parseToString(value);\r\n\t\treturn !!parsedVal;\r\n\t}\r\n\r\n\t/**\r\n\t * Clear the whole window.localStorage\r\n\t */\r\n\tclear() {\r\n\t\tthis.storage.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Removes window.localstorage values by keys provide in array\r\n\t * @param {array} arr\r\n\t */\r\n\tclearSpecified(arr) {\r\n\t\tif (!Array.isArray(arr)) {\r\n\t\t\tthrow new TypeError('Array not provided');\r\n\t\t}\r\n\t\tfor (let i = 0; i < arr.length; ++i) {\r\n\t\t\tthis.storage.removeItem(this._parseToString(arr[i]));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Return size of localstorage\r\n\t * @return {number}\r\n\t */\r\n\tsize() {\r\n\t\treturn this.storage.length;\r\n\t}\r\n\r\n\t/**\r\n\t * Parse value to stringified JSON\r\n\t * @param {*} value\r\n\t * @return {string}\r\n\t * @private\r\n\t */\r\n\t_parseToString(value) {\r\n\t\tswitch (typeof value) {\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'object': {\r\n\t\t\t\treturn JSON.stringify(value);\r\n\t\t\t}\r\n\t\t\tdefault: {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":["constructor","window","localStorage","sessionStorage","TypeError","storage","add","_parseToString","setItem","addSafely","getItem","ReferenceError","get","saveMap","prototype","toString","call","getMap","Map","length","key","set","keyExists","valueExists","clear","clearSpecified","Array","isArray","removeItem","size","JSON","stringify"],"mappings":"8EAMA,WAAe,KAAM,CAKpBA,cAAqB,CACpB,GAAI,IAAYC,OAAOC,YAAnB,EACH,IAAYD,OAAOE,cADpB,CAEC,KAAM,IAAIC,UAAJ,CAAc,wBAAd,CAAN,CAFD,IAIC,MAAKC,OAAL,EAED,CAODC,QAAgB,CAEf,OADA,EAAM,KAAKC,cAAL,GACN,CAAQ,QAAR,EACC,IAAK,QAAL,CAAe,CACd,KAAM,GAAY,KAAKA,cAAL,GAAlB,CACA,KAAKF,OAAL,CAAaG,OAAb,KAFc,CAGd,KACA,CACD,QACC,KAAKH,OAAL,CAAaG,OAAb,KADD,CAND,CAUA,CAQDC,cAAsB,CACrB,EAAM,KAAKF,cAAL,GADe,CAErB,KAAM,GAAY,KAAKF,OAAL,CAAaK,OAAb,GAAlB,CACA,KACC,KAAM,IAAIC,eAAJ,CAAmB,gCAAnB,CAAN,CAED,KAAKL,GAAL,KACA,CAODM,MAAS,CAER,MADA,GAAM,KAAKL,cAAL,GACN,CAAO,KAAKF,OAAL,CAAaK,OAAb,GACP,CAMDG,UAAa,CACZ,KAAM,GAAgD,cAAxC,UAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,GAAd,CACA,GAAI,EAAJ,CACC,KAAM,IAAIZ,UAAJ,CAAc,qBAAd,CAAN,CAED,IAAK,GAAI,KAAT,KACC,KAAKE,GAAL,KAED,CAMDW,QAAS,CACR,KAAM,GAAgB,GAAIC,IAA1B,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,KAAKb,OAAL,CAAac,MAAjC,CAAyC,GAAzC,CAA8C,CAC7C,GAAI,GAAU,KAAKZ,cAAL,CAAoB,KAAKF,OAAL,CAAae,GAAb,GAApB,CAAd,CACI,EAAU,KAAKb,cAAL,CAAoB,KAAKF,OAAL,CAAaK,OAAb,GAApB,CADd,CAEA,EAAcW,GAAd,KACA,CACD,QACA,CAODC,YAAe,CACd,MAAO,CAAC,CAAC,KAAKjB,OAAL,CAAaK,OAAb,CAAqB,KAAKH,cAAL,GAArB,CACT,CAODgB,cAAmB,CAClB,KAAM,GAAY,KAAKhB,cAAL,GAAlB,CACA,MAAO,CAAC,EACR,CAKDiB,OAAQ,CACP,KAAKnB,OAAL,CAAamB,KAAb,EACA,CAMDC,iBAAoB,CACnB,GAAI,CAACC,MAAMC,OAAN,GAAL,CACC,KAAM,IAAIvB,UAAJ,CAAc,oBAAd,CAAN,CAED,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,EAAIe,MAAxB,CAAgC,GAAhC,CACC,KAAKd,OAAL,CAAauB,UAAb,CAAwB,KAAKrB,cAAL,CAAoB,IAApB,CAAxB,CAED,CAMDsB,MAAO,CACN,MAAO,MAAKxB,OAAL,CAAac,MACpB,CAQDZ,iBAAsB,CACrB,OAAQ,QAAR,EACC,IAAK,QAAL,CACA,IAAK,QAAL,CACC,MAAOuB,MAAKC,SAAL,GAAP,CAED,QACC,SANF,CASA,CArJmB,CAArB"}